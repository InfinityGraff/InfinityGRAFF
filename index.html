<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>SVG Manipulation</title>
  <style>
    body{background-color: aquamarine;}
  </style>
</head>
<body>
  <div id="ListCor">
    <input type="color" value="" onchange="ReloadCor()">
    <input type="color" value="" onchange="ReloadCor()">
    <input type="color" value="" onchange="ReloadCor()">
    <input type="color" value="" onchange="ReloadCor()">
  </div>
  <button onclick="downloadSVGs()">Baixar SVGs</button>

  <div id="Rsut1"></div>
  <div id="Rsut2"></div>
  <div id="Rsut3"></div>
</body>

<script>

function FetchSVG(url, callback) {
    var xhr = new XMLHttpRequest();
    xhr.open('GET', url);
    xhr.onload = function () {
        if (xhr.status === 200) {
            callback(xhr.responseText);
        } else {
            console.error('Erro:', xhr.statusText);
        }
    };
    xhr.onerror = function () {
        console.error('Erro de rede.');
    };
    xhr.send();
}


//<script src="https://code.jquery.com/jquery-3.6.4.min.js">
//function FetchSVG(url,Call){$.ajax({url:url,method:'GET',dataType:'html',success:e=>{Call(e)},error:err=>{console.error('Erro:',err)}})}
  const VazarSVG = (svg)=>svg.replace(/"\/>\s*<path class="fil[123]" d="/g,'')
  const Tmplt_ImgSVG = (svg)=>`<img src="data:image/svg+xml,${encodeURIComponent(svg)}">`
  const RplcCor=(Svg,Cores)=>{Cores.forEach((cor,idx)=>{Svg=Svg.replace(new RegExp(`\\.fil${idx}\\s\\{fill:.*\\}`),`.fil${idx} {fill:${cor.value}}`)});return Svg}


  
  function EditarSVG(svg,div){
    const Cores = document.querySelectorAll('#ListCor input')
    const NovaCor = Cores[0].value==="#000000" ? svg : RplcCor(svg,Cores)
    document.querySelector(div).innerHTML += Tmplt_ImgSVG(NovaCor)
    document.querySelector(div).innerHTML += Tmplt_ImgSVG(VazarSVG(NovaCor))
  }

  function ReloadCor(){
    document.querySelector('#Rsut1').innerHTML = ''
    document.querySelector('#Rsut2').innerHTML = ''
    FetchSVG('Desenho (1).svg',svg=>{EditarSVG(svg,'#Rsut1')})
    FetchSVG('Desenho (2).svg',svg=>{EditarSVG(svg,'#Rsut2')})
    FetchSVG('Desenho (3).svg',svg=>{EditarSVG(svg,'#Rsut3')})
  }ReloadCor()


  






  function downloadSVGs(){
    var combinedSVG = $('#NOVOSVGPOLO').html()
    var blob = new Blob([combinedSVG],{type:'image/svg+xml'})
    var link = document.createElement('a')
    link.href = window.URL.createObjectURL(blob)
    link.download = 'combined.svg'
    link.click()
  }

  

  /*
  function showSVGAsText(){
    var svgText = new XMLSerializer().serializeToString($('#Result svg')[0])
    var svgText2 = new XMLSerializer().serializeToString($('#Result svg')[1])

    var newpath = svgText2.match(/<path\sclass.*\/>/g)
    var newtxt = svgText.replace(/\.fil0.*}/g,`.fil0{fill:${$('#colorInput').val()}}`)
    var newtxt2 = newtxt.replace(/<\/g>/g,newpath+'</g>')
    
    $('#SVGText').text(newpath)
    $('#NewSVGalterado').html(newtxt2)
  }
  */
  
  
  </script>
</html>


